mxcp: 1.0.0
tool:
  name: aggregate_licenses
  description: Aggregate licenses data by various dimensions
  parameters:
  - name: groupByLicenseBranchFlag
    type: boolean
    description: Group by LicenseBranchFlag
    default: false
  - name: filterLicenseBranchFlag
    type: string
    description: Filter by LicenseBranchFlag
    default: null
  return:
    type: array
    items:
      type: object
  source:
    code: "SELECT\n  CASE WHEN $groupByLicenseBranchFlag THEN license_branch_flag\
      \ ELSE 'All' END as license_branch_flag,\n  COUNT(*) as total_count,\n  COUNT(DISTINCT\
      \ license_pk) as unique_licenses\nFROM dim_licenses\nWHERE 1=1\n  AND ($filterLicenseBranchFlag\
      \ IS NULL OR license_branch_flag = $filterLicenseBranchFlag)\nGROUP BY 1\nORDER\
      \ BY total_count DESC\nLIMIT 100"
  enabled: true
